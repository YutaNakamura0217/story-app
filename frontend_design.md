
# フロントエンド設計概要 - 哲学絵本プラットフォーム

## 1. はじめに

このドキュメントは、「哲学絵本プラットフォーム」のフロントエンドアプリケーションに関する設計と構造の概要をまとめたものです。各ページの目的、主要コンポーネント、機能、UI/UXのポイントなどを記述し、開発チーム内の認識共有や将来のメンテナンス性の向上を目的とします。

## 2. 全体的なアーキテクチャと共通要素

### 2.1. 主要技術スタック

-   **UIライブラリ**: React (v19.1)
-   **言語**: TypeScript
-   **ルーティング**: React Router DOM (v7)
-   **スタイリング**: Tailwind CSS (v3)
-   **アイコン**: Heroicons (via @heroicons/react), カスタムSVGアイコン
-   **モジュールバンドラ**: (esbuild via `esm.sh` for CDN build)

### 2.2. グローバル状態管理

-   **認証状態 (`hooks/useAuth.tsx`)**:
    -   `AuthProvider` と `useAuth` フックにより、ユーザーの認証状態（ログイン済みか、ユーザー情報など）を管理します。
    -   ログイン、ログアウト処理、認証状態のローディングを扱います。
    -   認証情報は `localStorage` に（モックとして）永続化されます。
-   **お気に入り状態 (`hooks/useFavorites.tsx`)**:
    -   `FavoritesProvider` と `useFavorites` フックにより、ユーザーがお気に入りに追加した書籍IDのセットを管理します。
    -   お気に入り状態の取得、トグル（追加/削除）機能を提供します。
    -   お気に入り情報は `localStorage` に永続化されます。

### 2.3. 共通レイアウトコンポーネント

-   **`components/layout/Header.tsx`**:
    -   アプリケーション全体のヘッダー。`simple` (ロゴと言語選択のみ) と `main` (ナビゲーション、検索バー、ユーザープロファイル付き) の2バリアント。
    -   レスポンシブ対応（モバイルメニュー）。
-   **`components/layout/Footer.tsx`**:
    -   アプリケーション全体のフッター。`simple` と `main` の2バリアント。
-   **`components/layout/Logo.tsx`**:
    -   プラットフォームのロゴとサイト名を表示。クリックでホームへ遷移。
-   **`components/layout/LanguageSelector.tsx`**:
    -   言語切り替え用ドロップダウン（現在はモック）。
-   **`components/layout/SettingsLayout.tsx`**:
    -   ユーザー管理関連ページ（プロフィール設定、アカウント設定など）用の共通レイアウト。
    -   左側に `SettingsSidebar`、右側に各設定ページのコンテンツを表示。
-   **`components/layout/SettingsSidebar.tsx`**:
    -   `SettingsLayout` 内で使用されるナビゲーションサイドバー。

### 2.4. 再利用可能なUIコンポーネント (`components/ui/`)

-   **`Button.tsx`**: 多様なバリアント（primary, secondary, outline, ghost, danger）とサイズを持つ汎用ボタン。ローディング状態、アイコン表示に対応。`as` prop で `Link` など他の要素としてもレンダリング可能。
-   **`Input.tsx`**: ラベル、アイコン、エラー表示、パスワード表示切り替え機能付きの入力フィールド。
-   **`Card.tsx`**: コンテンツを区画化して表示するためのカードコンポーネント。`CardHeader`, `CardContent`, `CardFooter` を含む。
-   **`Select.tsx`**: カスタマイズ可能なセレクトドロップダウン。
-   **`Tabs.tsx`**: タブ切り替えUI。`Tab` コンポーネントを子要素として使用。
-   **`Avatar.tsx`**: ユーザーや子供のアバター画像を表示。画像がない場合はイニシャルを表示。
-   **`Badge.tsx`**: ステータスやタグを視覚的に表示するためのバッジ。
-   **`ProgressBar.tsx`**: 進捗状況を視覚的に示すプログレスバー。
-   **`PaginationControls.tsx`**: リスト表示のページネーションUI。

## 3. ページごとの詳細解説

### 3.1. 認証関連ページ

#### 3.1.1. ログインページ (`/login`)

-   **目的**: 既存ユーザーがプラットフォームにログインするためのページ。
-   **主要コンポーネント**: `Header (simple)`, `Footer (simple)`, `LoginForm`, `SocialLoginButtons`, `Card`.
-   **主な機能**:
    -   メールアドレスとパスワードによるログイン。
    -   入力バリデーションとエラー表示。
    -   「ログイン状態を保存する」オプション（モック）。
    -   パスワードリセットページへのリンク。
    -   ソーシャルログインボタン（Google, Twitter - モック）。
    -   会員登録ページへの誘導リンク。
-   **状態管理**: `LoginForm` 内のローカルステート（入力値、エラー）、`useAuth().login` を使用。
-   **UI/UX**: クリーンで分かりやすいフォーム。エラーメッセージは明確に。

#### 3.1.2. 会員登録ページ (`/register`)

-   **目的**: 新規ユーザーがアカウントを作成するためのページ。
-   **主要コンポーネント**: `Header (simple)`, `Footer (simple)`, `RegistrationForm`, `Card`.
-   **主な機能**:
    -   アカウント種別選択（保護者/教育者）。
    -   基本情報入力（氏名、メールアドレス、パスワード）。
    -   保護者の場合、お子様情報入力（名前、年齢、アバターURL - 動的追加/削除可）。
    -   利用規約同意チェック。
    -   入力バリデーションとエラー表示。
    -   登録完了後、ログインページへリダイレクト（モック）。
-   **状態管理**: `RegistrationForm` 内のローカルステート（入力値、エラー、お子様情報リスト）。
-   **UI/UX**: ステップが分かりやすいフォーム構成。お子様情報入力はインタラクティブに。

#### 3.1.3. パスワードリセット申請ページ (`/reset-password`)

-   **目的**: パスワードを忘れたユーザーがリセットを申請するためのページ。
-   **主要コンポーネント**: `Header (simple)`, `Footer (simple)`, `Input`, `Button`, `Card`.
-   **主な機能**:
    -   登録メールアドレスを入力。
    -   送信後、リセット手順メール送信のメッセージ表示（モック）。
    -   ログインページへ戻るリンク。
-   **状態管理**: ローカルステート（メールアドレス、メッセージ、ローディング状態）。
-   **UI/UX**: シンプルで迷わない操作性。

#### 3.1.4. パスワード変更ページ (`/change-password`)

-   **目的**: パスワードリセットフローの最終ステップ。新しいパスワードを設定する。
-   **主要コンポーネント**: `Header (simple)`, `Footer (simple)`, `Input`, `Button`, `Card`.
-   **主な機能**:
    -   新しいパスワードと確認用パスワードを入力。
    -   バリデーション（8文字以上、一致確認）。
    -   成功時、パスワード更新完了メッセージ表示とログインページへのリダイレクト（モック）。
-   **状態管理**: ローカルステート（パスワード入力値、エラー、メッセージ、ローディング状態）。
-   **UI/UX**: セキュリティを意識した明確な指示。

### 3.2. メインコンテンツページ

#### 3.2.1. ダッシュボード・ホーム (`/dashboard`)

-   **目的**: ログイン後のメインページ。ユーザーに関連する情報を集約して表示。
-   **主要コンポーネント**: `Header (main)`, `Footer (main)`, `WelcomeSection`, `ChildrenProgressSection`, `PhilosophyThemesSection`, `RecommendedBooksSection`.
-   **主な機能**:
    -   ウェルカムメッセージ表示。
    -   お子様の進捗サマリー表示（保護者の場合）。
    -   おすすめの哲学テーマ一覧表示。
    -   おすすめの絵本一覧表示。
-   **状態管理**: `useAuth` からユーザー情報を取得。各セクションは主に `constants.ts` のモックデータを表示。
-   **UI/UX**: 情報を整理し、視覚的に魅力的で、次のアクションへ誘導しやすいデザイン。WonderWiseテーマカラーを基調。

#### 3.2.2. 書籍一覧ページ (`/books`)

-   **目的**: プラットフォーム上の全絵本を一覧表示し、検索・フィルタリング・ソート機能を提供。
-   **主要コンポーネント**: `Header (main)`, `Footer (main)`, `PageTitleSection`, `FilterAndSortSection`, `BookListArea`, `PaginationControls`, `BookCard`.
-   **主な機能**:
    -   キーワード検索。
    -   哲学テーマ、対象年齢、書籍タイプ（読み放題/プレミアム/無料）によるフィルタリング。
    -   人気順、新着順、タイトル順などでのソート。
    -   書籍カード形式での一覧表示。
    -   お気に入り追加/削除機能（`useFavorites`フック使用）。
    -   ページネーション。
    -   ローディング中/検索結果なしの場合の表示。
-   **状態管理**: ローカルステート（フィルター条件、ソート条件、現在ページ、表示書籍リスト）、`useFavorites`。
-   **UI/UX**: 絵本の表紙を魅力的に表示。直感的なフィルター操作。レスポンシブ対応。

#### 3.2.3. 書籍詳細ページ (`/books/:id`)

-   **目的**: 特定の絵本の詳細情報を表示。概要、哲学的質問、レビュー、ディスカッションなど。
-   **主要コンポーネント**: `Header (main)`, `Footer (main)`, `BookHeroSection`, `BookTabsComponent` (`OverviewContent`, `QuestionsContent`, `ReviewsContent`, `DiscussionsContent`), `PhilosophyQuestion`, `BookCard` (関連書籍用)。
-   **主な機能**:
    -   書籍の基本情報（タイトル、著者、表紙、説明、対象年齢、読書時間など）表示。
    -   「読む」ボタン（読書ページへ遷移）。
    -   お気に入り追加/削除ボタン。
    -   タブ切り替えで「概要」「質問」「レビュー」「ディスカッション」を表示。
        -   **質問タブ**: 関連する哲学質問一覧表示。各質問は質問回答ページへリンク。
        -   **レビュータブ**: レビュー概要とレビュー一覧表示。レビュー投稿機能（モック）。
        -   **ディスカッションタブ**: 関連ディスカッションのサマリー表示、新規ディスカッション開始モーダル、全ディスカッションページへのリンク。
    -   関連書籍表示。
-   **状態管理**: `useParams` で書籍ID取得。ローカルステート（お気に入り状態、モーダル表示状態）。モックデータから書籍情報、質問、レビュー、ディスカッションサマリーを取得。
-   **UI/UX**: 書籍の魅力を最大限に伝えるリッチな表示。タブによる情報整理。

#### 3.2.4. 読書ページ (`/books/:id/read`)

-   **目的**: 絵本を閲覧・読書するための専用ページ。インタラクティブ機能を提供。
-   **主要コンポーネント**: `ReadingHeader`, `PageViewer` (`BookPageDisplay`), `ReadingTools`, `SidePanel`, `PhilosophyQuestionPopup`, `CompletionModal`.
-   **主な機能**:
    -   ページめくり（次へ/前へ）。
    -   読書進捗表示。
    -   音声読み上げ（モック、再生/一時停止ボタン）。
    -   ブックマーク追加/削除。
    -   メモ機能（サイドパネル内）。
    -   目次表示とナビゲーション（サイドパネル内）。
    -   特定のページで哲学的質問ポップアップ表示。
    -   読了時に読了モーダル表示。
-   **状態管理**: `useParams` で書籍ID取得。ローカルステート（現在ページ、サイドパネル表示状態・アクティブタブ、ブックマークリスト、ノートリスト、ポップアップ/モーダル表示状態、音声再生状態）。
-   **UI/UX**: 没入感を重視したデザイン。ヘッダーやツールバーは自動非表示/半透明化を想定。直感的な操作性。アクセシビリティ（読み上げ）。

#### 3.2.5. 哲学テーマ一覧ページ (`/themes`)

-   **目的**: プラットフォームで扱う哲学テーマを一覧表示し、関連書籍への導線を提供。
-   **主要コンポーネント**: `Header (main)`, `Footer (main)`, `PageHeroSection`, `ThemeCategoryNavigation`, `ThemeGridArea`, `ThemesPageThemeCard`.
-   **主な機能**:
    -   ヒーローセクションでページタイトルとキャッチコピー表示。
    -   テーマカテゴリ（すべて、じぶんのこと、ともだちのこと等）によるフィルタリング。
    -   テーマカード形式での一覧表示（アイコン/画像、テーマ名、問いかけ、おすすめ年齢、関連書籍数）。
    -   各テーマカードからテーマ別書籍一覧ページへリンク。
-   **状態管理**: ローカルステート（選択中カテゴリ、表示テーマリスト、ローディング状態）。
-   **UI/UX**: 子供の視点を意識したカラフルで探求心をくすぐるデザイン。テーマ名は問いかけ形式。

#### 3.2.6. テーマ別書籍一覧ページ (`/themes/:id/books`)

-   **目的**: 特定の哲学テーマに関連する絵本を一覧表示。
-   **主要コンポーネント**: `Header (main)`, `Footer (main)`, `ThemeHeaderSection`, `FilterAndSortSection` (書籍一覧ページと共通部品を流用・調整), `BookListArea`, `PaginationControls`.
-   **主な機能**:
    -   選択されたテーマのヘッダー情報表示（テーマ名、説明、戻るリンク）。
    -   テーマ内でのキーワード検索、年齢フィルタリング、ソート機能。
    -   書籍カード形式での一覧表示。
    -   ページネーション。
-   **状態管理**: `useParams` でテーマID取得。ローカルステート（フィルター条件、ソート条件、現在ページ）。`useFavorites`。
-   **UI/UX**: どのテーマを見ているかが明確。書籍一覧ページと一貫性のある操作性。

#### 3.2.7. 検索結果ページ (`/search`)

-   **目的**: ヘッダーのグローバル検索バーからのキーワード検索結果を表示。
-   **主要コンポーネント**: `Header (main)`, `Footer (main)`, `SearchHeaderSection`, `FilterAndSortSection` (書籍一覧ページと共通部品を流用・調整), `BookListArea`, `PaginationControls`.
-   **主な機能**:
    -   検索キーワードと結果件数表示。再検索可能な検索バー。
    *   将来的には結果カテゴリタブ（絵本/テーマなど）も検討。
    -   検索結果に対するさらなるフィルタリング、ソート機能。
    -   書籍カード形式での一覧表示。
    -   ページネーション。
    -   検索結果がない場合のメッセージ表示。
-   **状態管理**: `useSearchParams` で検索クエリ取得。ローカルステート（フィルター条件、ソート条件、現在ページ）。`useFavorites`。
-   **UI/UX**: 検索クエリと結果が明確。再検索の容易さ。

#### 3.2.8. お気に入り一覧ページ (`/favorites`)

-   **目的**: ユーザーがお気に入り登録した絵本を一覧表示。
-   **主要コンポーネント**: `Header (main)`, `Footer (main)`, `PageTitleSection (favorites version)`, `FilterAndSortSection (favorites version)`, `BookListArea`, `PaginationControls`.
-   **主な機能**:
    -   お気に入り絵本一覧をカード形式で表示。
    -   各カードからお気に入り削除可能。
    -   テーマ、年齢によるフィルタリング。
    -   追加順、タイトル順などでのソート。
    -   ページネーション。
    -   お気に入りが0件の場合のメッセージと絵本検索への誘導。
-   **状態管理**: `useFavorites` からお気に入り書籍IDリストを取得。ローカルステート（フィルター条件、ソート条件、現在ページ）。
-   **UI/UX**: パーソナルなリストであることを感じさせる温かみのあるデザイン。削除操作の明確さ。

### 3.3. ユーザー管理ページ (`SettingsLayout` を使用)

#### 3.3.1. プロフィール設定ページ (`/profile`)

-   **目的**: ユーザー自身の基本情報（名前、アバター、自己紹介）を設定・変更。
-   **主要コンポーネント**: `ProfileForm`.
-   **主な機能**:
    -   アバター画像アップロード（モック）。
    -   名前編集。
    -   ユーザー種別、メールアドレス表示（編集不可、アカウント設定へ誘導）。
    -   自己紹介編集（任意）。
    -   変更内容保存。
-   **状態管理**: `useAuth` からユーザー情報取得。`ProfileForm` 内ローカルステート（フォーム入力値）。
-   **UI/UX**: 編集可能項目と表示のみ項目を明確化。

#### 3.3.2. 子供一覧管理ページ (`/children`)

-   **目的**: 登録済みのお子様情報を一覧表示し、追加・編集・詳細確認への導線を提供。
-   **主要コンポーネント**: `ChildManagementCard`.
-   **主な機能**:
    -   お子様情報カード一覧（アバター、名前、年齢）。
    -   各カードに「進捗を見る」「編集」「削除」ボタン。
    -   「新しいお子さまを追加する」ボタン（子供追加ページへリンク）。
    -   お子様がいない場合のEmpty State表示。
-   **状態管理**: モックデータ `MOCK_CHILDREN` を使用。
-   **UI/UX**: 各子供の情報とアクションが分かりやすいカードデザイン。

#### 3.3.3. 子供追加ページ (`/children/add`)

-   **目的**: 新しいお子様の情報を登録。
-   **主要コンポーネント**: `AddChildForm`.
-   **主な機能**:
    -   お子様の名前、年齢、アバター（プリセット選択/URL入力/アップロードモック）、興味のあること（任意）を入力。
    -   入力バリデーション。
    -   保存、キャンセル機能。
-   **状態管理**: `AddChildForm` 内ローカルステート（フォーム入力値）。
-   **UI/UX**: シンプルで分かりやすいフォーム。アバター選択は楽しく。

#### 3.3.4. 子供編集ページ (`/children/:id/edit`)

-   **目的**: 既存のお子様の情報を編集。
-   **主要コンポーネント**: `EditChildForm`.
-   **主な機能**:
    -   子供追加フォームと同様の項目を編集。
    -   フォームは既存情報でプリセット（モック）。
-   **状態管理**: `useParams` で子供ID取得。`EditChildForm` 内ローカルステート（フォーム入力値）。
-   **UI/UX**: 子供追加ページと一貫したデザイン。

#### 3.3.5. 子供詳細・進捗ページ (`/children/:id`) (SettingsLayout内)

-   **目的**: 特定のお子様の詳細情報、学習進捗、読書履歴、達成状況などを表示。
-   **主要コンポーネント**: `ChildDetailContent` (プロフィールセクション、タブナビゲーション: 進捗、読んだ本、考えたこと、バッジ)。
-   **主な機能**:
    -   お子様のプロフィール概要（アバター、名前、年齢）と編集ボタン。
    -   全体の進捗サマリー。
    -   タブでカテゴリ分けされた詳細情報表示（内容はモック/プレースホルダー）。
    -   おすすめ絵本表示（任意）。
-   **状態管理**: `useParams` で子供ID取得。モックデータから子供情報を表示。
-   **UI/UX**: 保護者が子供の成長を把握しやすい視覚的な情報整理。子供自身が見ても楽しいデザイン。

#### 3.3.6. 学習履歴ページ (`/learning-history`)

-   **目的**: アカウント全体または子供ごとの学習アクティビティを時系列で表示。
-   **主要コンポーネント**: `LearningHistoryItem`.
-   **主な機能**:
    -   お子様選択フィルター、期間フィルター（モック）。
    -   タイムライン形式での履歴表示（日付、子供アバター、アクティビティ種別アイコン、内容、詳細リンク）。
    -   ページネーション（将来的に）。
-   **状態管理**: ローカルステート（フィルター条件）。モックデータ `MOCK_ACTIVITIES` を使用。
-   **UI/UX**: 直感的なタイムライン表示。アイコンによるアクティビティ種別の視認性向上。

#### 3.3.7. アカウント設定ページ (`/settings`)

-   **目的**: メールアドレス、パスワード、通知設定、プランなどアカウント全体の設定。
-   **主要コンポーネント**: `Tabs`, `AccountInfoSettings`, `SecuritySettings`, `NotificationSettings`, `SubscriptionSettings`.
-   **主な機能**:
    -   タブで設定項目を分類（基本情報、セキュリティ、通知、プラン・お支払い）。
    -   各タブ内で関連設定フォーム/情報表示（メールアドレス変更、パスワード変更、通知ON/OFF、プラン確認など - モック）。
-   **状態管理**: 各設定タブコンポーネント内のローカルステート。`useAuth` からユーザー情報取得。
-   **UI/UX**: 複雑な設定をタブで整理。各設定項目は分かりやすく。

### 3.4. インタラクティブ機能ページ

#### 3.4.1. 書籍ディスカッションページ (`/books/:id/discussions`)

-   **目的**: 特定の書籍に関するすべてのディスカッショントピックを一覧表示し、各スレッドの閲覧や新規投稿を可能にする。
-   **主要コンポーネント**: `BookDiscussionHeader`, `DiscussionListItem`, `DiscussionThreadView`, `StartDiscussionModal` (書籍詳細ページと共通部品)。
-   **主な機能**:
    -   書籍情報ヘッダー表示。
    -   その書籍の全ディスカッションをリスト表示（タイトル、作成者、参加者数、最終更新）。
    -   リストからディスカッションを選択すると、スレッド詳細（投稿一覧）を表示。
    -   スレッド内で新規投稿（モック）。
    -   ページからも新しいディスカッションを開始可能。
-   **状態管理**: `useParams` で書籍ID取得。ローカルステート（選択中ディスカッション、表示投稿リスト、モーダル表示状態）。モックデータ `MOCK_DISCUSSION_SUMMARIES`, `MOCK_DISCUSSION_POSTS` を使用。
-   **UI/UX**: リストと詳細ビューを効果的に配置。投稿はチャット風。

#### 3.4.2. 質問回答ページ (`/books/:bookId/questions/:questionId/answer`)

-   **目的**: 特定の書籍の特定の哲学質問に対して、ユーザー（子供）が回答を入力・考察するための専用ページ。
-   **主要コンポーネント**: `QuestionHeaderComponent`, `QuestionContentComponent`, `ResponseAreaComponent` (`TextResponseComponent`, placeholders for `DrawingResponseComponent`, `VoiceResponseComponent`, `ChoiceResponseComponent`), `SupportAreaComponent` (placeholder), `NavigationAreaComponent` (placeholder).
-   **主な機能**:
    -   書籍コンテキストと質問情報をヘッダーに表示。
    -   質問文、思考ステップ（ヒント）を表示。
    -   タブで回答方法を選択（Phase1ではテキスト回答がメイン）。
        -   **テキスト回答**: テキストエリアで回答入力。保存ボタンでコンソールに内容出力（モック）。
    -   保護者向けガイダンス、関連質問、休憩提案などのサポートエリア（プレースホルダー）。
    -   前後の質問への移動、セッション完了などのナビゲーション（プレースホルダー）。
-   **状態管理**: `useParams` で書籍IDと質問ID取得。ローカルステート（回答入力値、選択中回答タブ）。モックデータから書籍・質問情報を取得。
-   **UI/UX**: 集中して思考できるレイアウト。質問文は大きく読みやすく。回答形式の選択肢提示。

### 3.5. ユーティリティページ

#### 3.5.1. 404 Not Found ページ (`*`)

-   **目的**: 存在しないURLにアクセスした場合に表示するフォールバックページ。
-   **主要コンポーネント**: `Header (simple)`, `Footer (simple)`, `Button`.
-   **主な機能**:
    -   エラーメッセージとイラスト（またはアイコン）表示。
    -   ホームページへ戻るボタン。
-   **UI/UX**: 親しみやすく、ユーザーを適切に誘導。

## 4. 今後の展望（主なもの）

-   **クリエイター向け機能**: 絵本投稿・管理、質問作成ツール、収益管理など。
-   **管理者向け機能**: コンテンツ管理、ユーザー管理、クリエイター審査、分析ダッシュボードなど。
-   **マネタイズ関連ページ**: 料金プラン一覧、決済ページ、サブスクリプション管理など。
-   **学習・進捗**: 学習進捗ダッシュボード、達成バッジ一覧など。
-   **回答の永続化**: ユーザー回答をバックエンドに保存し、表示する機能。
-   **ディスカッションの永続化**: ディスカッションと投稿をバックエンドに保存・取得する機能。
-   **AI機能**: 回答分析、パーソナライズされた推薦など。

---

このドキュメントは、プロジェクトの進行に合わせて継続的に更新されるべきです。

## 5. バックエンド実装状況メモ

現時点のバックエンドは認証および一部の書籍取得APIのみが実装されています。子供管
理、ユーザー設定、レビュー投稿、お気に入り、読書進捗など多くのエンドポイントが未
実装のため、フロントエンド側ではモックデータで代用しています。バックエンドが拡充
された際には、各ページのデータ取得ロジックを実APIに置き換える必要があります。
